
╭-------------------------------------------+--------------------+--------------------+------------------+------------------╮
| File                                      | % Lines            | % Statements       | % Branches       | % Funcs          |
+===========================================================================================================================+
| src/core/BaseOPF7702.sol                  | 81.63% (40/49)     | 79.25% (42/53)     | 28.57% (2/7)     | 91.67% (11/12)   |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/Execution.sol                    | 91.43% (32/35)     | 93.48% (43/46)     | 100.00% (6/6)    | 100.00% (6/6)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/KeysManager.sol                  | 93.04% (147/158)   | 92.90% (144/155)   | 100.00% (11/11)  | 100.00% (29/29)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702.sol                      | 95.22% (199/209)   | 96.34% (237/246)   | 96.08% (49/51)   | 100.00% (19/19)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702Recoverable.sol           | 93.62% (44/47)     | 93.48% (43/46)     | 100.00% (3/3)    | 100.00% (7/7)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPFMain.sol                      | 66.67% (2/3)       | 50.00% (1/2)       | 100.00% (0/0)    | 100.00% (1/1)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/GasPolicy.sol                   | 75.00% (51/68)     | 75.31% (61/81)     | 40.00% (6/15)    | 60.00% (6/10)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/SocialRecover.sol               | 99.43% (173/174)   | 96.55% (196/203)   | 83.67% (41/49)   | 100.00% (20/20)  |
╰-------------------------------------------+--------------------+--------------------+------------------+------------------╯
Compiling 158 files with Solc 0.8.29
Solc 0.8.29 finished in 38.09s
Compiler run successful with warnings:
Warning (3420): Source file does not specify required compiler version! Consider adding "pragma solidity ^0.8.29;"
--> script/DeployUpgradeable.s.sol

Warning (3420): Source file does not specify required compiler version! Consider adding "pragma solidity ^0.8.29;"
--> script/InitProxy.s.sol

Warning (7238): This assignment performs two copies to storage. Since storage copies do not first copy to a temporary location, one of them might be overwritten before the second is executed and thus may have unexpected effects. It is safer to perform the copies separately or assign to storage pointers first.
   --> test/unit/Recoverable.t.sol:596:9:
    |
596 |         (_signatures[0], _signatures[1]) = (_signatures[1], _signatures[0]);
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Warning (7238): This assignment performs two copies to storage. Since storage copies do not first copy to a temporary location, one of them might be overwritten before the second is executed and thus may have unexpected effects. It is safer to perform the copies separately or assign to storage pointers first.
   --> test/unit/Recoverable.t.sol:741:9:
    |
741 |         (_signatures[0], _signatures[1]) = (_signatures[1], _signatures[0]);
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Analysing contracts...
Running tests...

Ran 16 tests for test/gas/GasFuzzing.t.sol:GasFuzzing
[PASS] test_auto_init_handles_extreme_u64_basefee() (gas: 72321)
[PASS] test_auto_init_reverts_when_basefee_extreme() (gas: 72684)
[PASS] test_basic_accept_no_paymaster() (gas: 113349)
[PASS] test_cumulative_cost_limit_exceeded() (gas: 127280)
[PASS] test_fuzz_accept_within_auto_limits(uint96,uint96,uint96,uint64,uint64,uint8) (runs: 256, μ: 143306, ~: 134806)
[PASS] test_fuzz_overflow_guard_in_check(uint96,uint96,uint96,uint128,uint128) (runs: 256, μ: 96089, ~: 96425)
[PASS] test_init_ok() (gas: 9702)
[PASS] test_initialize_and_getters() (gas: 74295)
[PASS] test_malformed_paymaster_len_lt_offset_passes() (gas: 83483)
[PASS] test_penalty_boundary() (gas: 167995)
[PASS] test_perOpMaxCostWei_cap_triggers() (gas: 83569)
[PASS] test_price_zero_path() (gas: 118420)
[PASS] test_tx_limit_exceeded() (gas: 112160)
[PASS] test_uninitialized_fails() (gas: 23715)
[PASS] test_with_paymaster_blob_sample() (gas: 85530)
[PASS] test_wrong_caller_fails() (gas: 78410)
Suite result: ok. 16 passed; 0 failed; 0 skipped; finished in 130.96ms (126.52ms CPU time)

Ran 19 tests for test/gas/GasPolicyTest.t.sol:GasPolicyTest
[PASS] test_CheckUserOpPolicy() (gas: 132838)
[PASS] test_Init() (gas: 9883)
[PASS] test_checkUserOpPolicy_GasLimitExceeded() (gas: 77202)
[PASS] test_checkUserOpPolicy_NoPaymasterSuccess() (gas: 89953)
[PASS] test_checkUserOpPolicy_NotInitialized() (gas: 22798)
[PASS] test_checkUserOpPolicy_UnauthorizedCaller() (gas: 18376)
[PASS] test_checkUserOpPolicy_WithPaymasterSuccess() (gas: 85073)
[PASS] test_constructor_RevertsWhenDefaultZero() (gas: 39834)
[PASS] test_getGasConfigEx_ReturnsStruct() (gas: 72373)
[PASS] test_initializeGasPolicy() (gas: 72094)
[PASS] test_initializeGasPolicyAuto_RevertGasLimitHighMulOverflow() (gas: 1136017)
[PASS] test_initializeGasPolicyAuto_RevertGasLimitHighPerOp() (gas: 1136600)
[PASS] test_initializeGasPolicyAuto_RevertIdExists() (gas: 69173)
[PASS] test_initializeGasPolicyAuto_RevertLimitAboveUint32() (gas: 17678)
[PASS] test_initializeGasPolicyAuto_RevertLimitZero() (gas: 17425)
[PASS] test_initializeGasPolicyAuto_RevertNotSender() (gas: 13525)
[PASS] test_initializeGasPolicyManual_RevertIdExists() (gas: 68067)
[PASS] test_initializeGasPolicyManual_RevertNotSender() (gas: 13743)
[PASS] test_initializeGasPolicyManual_RevertZeroBudget() (gas: 17654)
Suite result: ok. 19 passed; 0 failed; 0 skipped; finished in 1.90ms (1.61ms CPU time)

Ran 2 tests for test/Deploy.t.sol:Deploy
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13452)
Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 1.60s (1.02ms CPU time)

Ran 6 tests for test/by-contract/StubSignatures.t.sol:StubSignature
[PASS] test_AfterDeploy7702() (gas: 35068)
[PASS] test_Attched7702() (gas: 13521)
[PASS] test_getEOAStubSig() (gas: 31678)
[PASS] test_getP256NonKeyStubSig() (gas: 65897)
[PASS] test_getP256StubSig() (gas: 65575)
[PASS] test_getWebAuthnStubSig() (gas: 154219)
Suite result: ok. 6 passed; 0 failed; 0 skipped; finished in 494.54ms (115.38ms CPU time)

Ran 3 tests for test/by-contract/Upgrade7702.sol:Upgrade7702
[PASS] test_AfterDeploy7702Proxy() (gas: 35068)
[PASS] test_Attched7702() (gas: 13298)
[PASS] test_upgradeProxyDelegation() (gas: 9103972)
Suite result: ok. 3 passed; 0 failed; 0 skipped; finished in 1.57ms (460.00µs CPU time)

Ran 4 tests for test/by-contract/BaseOPF7702Test.t.sol:BaseOPF7702Test
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13475)
[PASS] test_supportsInterface() (gas: 98766)
[PASS] test_tokensReceived() (gas: 29372)
Suite result: ok. 4 passed; 0 failed; 0 skipped; finished in 3.14s (1.07ms CPU time)

Ran 1 test for test/storage/ClearStorage.t.sol:ClearStorage
[PASS] testClearStorageResetsReservedSlots() (gas: 106522)
Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 265.50µs (152.38µs CPU time)

Ran 5 tests for test/by-contract/OPF7702RecoverableTest.t.sol:OPF7702RecoverableTest
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13521)
[PASS] test_RevertOPF7702Recoverable__AddressCantBeZero() (gas: 15639289)
[PASS] test_RevertOpenfortBaseAccount7702V1__InvalidSignature() (gas: 14933019)
[PASS] test_RevretOPF7702Recoverable_InsecurePeriodAndGasPolicy__InitializationIncorrect() (gas: 12788843)
Suite result: ok. 5 passed; 0 failed; 0 skipped; finished in 3.14s (1.54s CPU time)

Ran 3 tests for test/fuzz/KeysManagerFuzz.t.sol:KeysManagerFuzz
[PASS] testFuzz_updateKeyData(uint48,uint48) (runs: 256, μ: 67068, ~: 66478)
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13452)
Suite result: ok. 3 passed; 0 failed; 0 skipped; finished in 3.19s (54.38ms CPU time)

Ran 6 tests for test/fuzz/ExecutionFuzz.t.sol:ExecutionFuzz
[PASS] testFuzz_executeInvalidMode(bytes32) (runs: 256, μ: 47496, ~: 47496)
[PASS] testFuzz_executeTooManyCalls(uint8) (runs: 256, μ: 125649, ~: 117236)
[PASS] testFuzz_executeWithinLimit(uint8) (runs: 256, μ: 87574, ~: 80205)
[PASS] testFuzz_executeZeroLength() (gas: 42313)
[PASS] test_AfterDeploy7702() (gas: 35068)
[PASS] test_Attched7702() (gas: 13498)
Suite result: ok. 6 passed; 0 failed; 0 skipped; finished in 3.41s (271.92ms CPU time)

Ran 5 tests for test/fuzz/RecoverableGuardiansFuzz.t.sol:RecoverableGuardiansFuzz
[PASS] testFuzz_cancelGuardianProposal(address) (runs: 256, μ: 169889, ~: 169889)
[PASS] testFuzz_proposeAndConfirmGuardian(address) (runs: 256, μ: 245262, ~: 245262)
[PASS] testFuzz_revokeGuardian(address) (runs: 256, μ: 268195, ~: 268181)
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13475)
Suite result: ok. 5 passed; 0 failed; 0 skipped; finished in 3.58s (444.03ms CPU time)

Ran 5 tests for test/by-contract/OPF7702Test.t.sol:BaseOPF7702Test
[PASS] test_AfterDeploy7702() (gas: 35045)
[PASS] test_Attched7702() (gas: 13498)
[PASS] test_FullisValidSignatureEOA() (gas: 1408868)
[PASS] test_RevertKeyManager__InvalidSignatureLengthEOA() (gas: 66102)
[PASS] test_RevertKeyManager__InvalidSignatureLengthP256() (gas: 66681)
Suite result: ok. 5 passed; 0 failed; 0 skipped; finished in 3.70s (560.95ms CPU time)

Ran 11 tests for test/unit/UpgradeAddresses.t.sol:UpgradeAddresses
[PASS] test_AfterDeploy7702() (gas: 35091)
[PASS] test_Attched7702() (gas: 13544)
[PASS] test_UpgradeEPAAWithMK() (gas: 752614)
[PASS] test_UpgradeEPAAWithRootKey() (gas: 255102)
[PASS] test_UpgradeEPWithRootKey() (gas: 131386)
[PASS] test_UpgradeGasPolicyAAWithRootKey() (gas: 256143)
[PASS] test_UpgradeGasPolicyAAWithRootMK() (gas: 769228)
[PASS] test_UpgradeGasPolicyWithRootKey() (gas: 129853)
[PASS] test_UpgradeWebAuthVerifieAAWithMK() (gas: 760463)
[PASS] test_UpgradeWebAuthVerifieAAWithRootKey() (gas: 255891)
[PASS] test_UpgradeWebAuthVerifieWithRootKey() (gas: 128586)
Suite result: ok. 11 passed; 0 failed; 0 skipped; finished in 1.60s (564.90ms CPU time)

Ran 17 tests for test/by-contract/RecoverableReverts.t.sol:RecoverableReverts
[PASS] test_AfterDeploy7702() (gas: 35137)
[PASS] test_Attched7702() (gas: 13613)
[PASS] test_cancelGuardianRevertDuplicatedGuardian() (gas: 627330)
[PASS] test_completeRecoveryReverts() (gas: 1156497)
[PASS] test_completeRecoveryRevertsInvalidRecoverySignature() (gas: 1009859)
[PASS] test_confirmGuardianRevertAddressCantBeZero() (gas: 501488)
[PASS] test_confirmGuardianRevertDuplicatedGuardian() (gas: 629233)
[PASS] test_confirmGuardianRevertPendingProposalExpiredr() (gas: 504139)
[PASS] test_confirmGuardianRevertPendingProposalNotOver() (gas: 503121)
[PASS] test_confirmGuardianRevocationRevertPendingRevokeNotOverAndPendingRevokeExpired() (gas: 651227)
[PASS] test_proposeGuardianRevertDuplicatedGuardian() (gas: 590536)
[PASS] test_proposeGuardianRevertDuplicatedProposal() (gas: 510698)
[PASS] test_requireRecovery_NoOngoingRecovery_cancelRecovery() (gas: 62968)
[PASS] test_requireRecovery_NoOngoingRecovery_completeRecovery() (gas: 483292)
[PASS] test_requireRecovery_OngoingRecovery_confirmGuardianProposal() (gas: 523423)
[PASS] test_revokeGuardianRevertDuplicatedRevoke() (gas: 626428)
[PASS] test_startRecoveryRevertMustBeGuardianAndUnsupportedKeyTypeAndRecoverCannotBeActiveKey() (gas: 883579)
Suite result: ok. 17 passed; 0 failed; 0 skipped; finished in 940.77ms (576.65ms CPU time)

Ran 52 tests for test/unit/Recoverable.t.sol:Recoverable
[PASS] test_AfterDeploy7702() (gas: 35252)
[PASS] test_Attched7702() (gas: 13958)
[PASS] test_RevertCancelGuardianProposalDuplicatedGuardian() (gas: 408655)
[PASS] test_RevertCancelGuardianProposalUnauthorized() (gas: 160077)
[PASS] test_RevertCancelGuardianProposalUnknown() (gas: 210699)
[PASS] test_RevertCancelGuardianRevocationMustBeGuardian() (gas: 162295)
[PASS] test_RevertCancelGuardianRevocationUnauthorized() (gas: 159824)
[PASS] test_RevertCancelGuardianRevocationWhenNotGuardian() (gas: 209446)
[PASS] test_RevertCancelGuardianRevocationWhenUnknown() (gas: 360923)
[PASS] test_RevertCancelRecoveryUnauthorized() (gas: 16982)
[PASS] test_RevertCancelRecoveryWhenNoOngoingRecovery() (gas: 63543)
[PASS] test_RevertCompleteRecoveryInvalidSignatureAmount() (gas: 1322876)
[PASS] test_RevertCompleteRecoveryInvalidSignatureOrder() (gas: 1249192)
[PASS] test_RevertCompleteRecoveryInvalidSignaturesDirect() (gas: 1247985)
[PASS] test_RevertConfirmGuardianProposalDuringRecovery() (gas: 923730)
[PASS] test_RevertConfirmGuardianProposalUnauthorized() (gas: 159827)
[PASS] test_RevertConfirmGuardianProposalUnknown() (gas: 211277)
[PASS] test_RevertConfirmGuardianProposalWhenExpired() (gas: 281305)
[PASS] test_RevertConfirmGuardianProposalWhenPendingNotOver() (gas: 281467)
[PASS] test_RevertConfirmGuardianRevocationUnauthorized() (gas: 159045)
[PASS] test_RevertConfirmGuardianRevocationUnknown() (gas: 208952)
[PASS] test_RevertConfirmGuardianRevocationWhenExpired() (gas: 408586)
[PASS] test_RevertInitializeGuardiansUnauthorized() (gas: 160287)
[PASS] test_RevertOPF7702Recoverable__AddressCantBeZeroAndGuardianCannotBeAddressThis() (gas: 188277)
[PASS] test_RevertProposeGuardianUnauthorized() (gas: 158697)
[PASS] test_RevertProposeGuardianWhenLocked() (gas: 997712)
[PASS] test_RevertRevokeGuardianDuplicatedRevoke() (gas: 408351)
[PASS] test_RevertRevokeGuardianMustBeGuardian() (gas: 208132)
[PASS] test_RevertRevokeGuardianUnauthorized() (gas: 160373)
[PASS] test_RevertSocialRecoveryManagerInsecurePeriod() (gas: 48970)
[PASS] test_RevertStartRecoveryKeyCantBeZero() (gas: 807069)
[PASS] test_RevertStartRecoveryOngoing() (gas: 983427)
[PASS] test_RevertStartRecoveryUnauthorized() (gas: 240491)
[PASS] test_RevertStartRecoveryUnsupportedKeyType() (gas: 843470)
[PASS] test_RevertStartRecoveryWhenKeyActive() (gas: 887915)
[PASS] test_cancelGuardianProposalAAWithRootKey() (gas: 670190)
[PASS] test_cancelGuardianProposalWithRootKey() (gas: 583129)
[PASS] test_cancelGuardianRevocationAAWithRootKey() (gas: 1120079)
[PASS] test_cancelGuardianRevocationWithRootKey() (gas: 994187)
[PASS] test_cancelRecoveryWithRootKey() (gas: 1008309)
[PASS] test_confirmGuardianProposalAAWithRootKey() (gas: 892828)
[PASS] test_confirmGuardianProposalWithRootKey() (gas: 820095)
[PASS] test_confirmGuardianRevocationAAWithRootKey() (gas: 991714)
[PASS] test_confirmGuardianRevocationWithRootKey() (gas: 891056)
[PASS] test_confirmRecoveryWithRootKeyNewOwnerEOA() (gas: 1361247)
[PASS] test_confirmRecoveryWithRootKeyNewOwnerWebAuthn() (gas: 1453704)
[PASS] test_proposeGuardianAAWithRootKey() (gas: 614945)
[PASS] test_proposeGuardianWithRootKey() (gas: 548187)
[PASS] test_revokeGuardianProposalAAWithRootKey() (gas: 1064674)
[PASS] test_revokeGuardianProposalWithRootKey() (gas: 958417)
[PASS] test_startRecoveryWithRootKeyNewOwnerEOA() (gas: 1054833)
[PASS] test_startRecoveryWithRootKeyNewOwnerWebAuthn() (gas: 1141519)
Suite result: ok. 52 passed; 0 failed; 0 skipped; finished in 1.15s (668.45ms CPU time)

Ran 4 tests for test/fuzz/UserOpExecutionFuzz.t.sol:UserOpExecutionFuzz
[PASS] testFuzz_userOpWithMasterKey(uint256,uint256,uint256) (runs: 256, μ: 245573, ~: 247711)
[PASS] testFuzz_userOpWithSessionKey(uint256,uint256,uint256) (runs: 256, μ: 443766, ~: 445181)
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13475)
Suite result: ok. 4 passed; 0 failed; 0 skipped; finished in 1.18s (813.64ms CPU time)

Ran 28 tests for test/by-contract/KeyManagerTest.t.sol:KeyManagerTest
[PASS] test_AfterDeploy7702() (gas: 35878)
[PASS] test_AfterInitialize() (gas: 149211)
[PASS] test_Attched7702() (gas: 13963)
[PASS] test_Revert_KeyNotActive() (gas: 81120)
[PASS] test_Revert_TokenAddressZero_TargetAddressZero_TargetIsThis_AddressZer() (gas: 324460)
[PASS] test_clearExecutePermissions() (gas: 319771)
[PASS] test_pauseKey() (gas: 319298)
[PASS] test_pauseKey_unpauseKeyRevert_KeyAlreadyPaused_KeyAlreadyActive() (gas: 299637)
[PASS] test_registerKey() (gas: 334608)
[PASS] test_registerKeyCustodial() (gas: 311694)
[PASS] test_registerKeyRevert_BadTimestamps() (gas: 194660)
[PASS] test_registerKeyRevert_KeyCantBeZero() (gas: 69873)
[PASS] test_registerKeyRevert_KeyRegistered() (gas: 279490)
[PASS] test_registerKeyRevert_MustHaveLimits() (gas: 135539)
[PASS] test_removeTokenSpend() (gas: 338580)
[PASS] test_removeTokenSpend_TokenSpendNotSet() (gas: 372713)
[PASS] test_requireForExecuteRevert() (gas: 247711)
[PASS] test_revokeKey() (gas: 383948)
[PASS] test_setCanCall() (gas: 347225)
[PASS] test_setTokenSpend() (gas: 384331)
[PASS] test_setTokenSpendRevert_MustHaveLimits() (gas: 282461)
[PASS] test_setTokenSpendRevert_TokenSpendAlreadySet() (gas: 373619)
[PASS] test_unpauseKey() (gas: 339928)
[PASS] test_updateCanCall() (gas: 321556)
[PASS] test_updateKeyData() (gas: 302801)
[PASS] test_updateKeyDataRevert_KeyRegistered_MustHaveLimits() (gas: 305925)
[PASS] test_updateTokenSpend() (gas: 399437)
[PASS] test_updateTokenSpend_TokenSpendNotSet() (gas: 373726)
Suite result: ok. 28 passed; 0 failed; 0 skipped; finished in 6.59s (3.22s CPU time)

Ran 13 tests for test/by-contract/OPF7702WithDiffKeys.t.sol:OPF7702WithDiffKeys
[PASS] test_AfterDeploy7702() (gas: 35091)
[PASS] test_Attched7702() (gas: 13659)
[PASS] test_ExecuteAAWithSKP256SelfFailedAllValidations() (gas: 929714)
[PASS] test_sentBatchUserOpWithSKEOAFailedKeyValidation() (gas: 626427)
[PASS] test_sentUserOpWithMKEOA() (gas: 342972)
[PASS] test_sentUserOpWithSKEOA() (gas: 754947)
[PASS] test_sentUserOpWithSKEOAAllPaths() (gas: 850342)
[PASS] test_sentUserOpWithSKEOAFailedAllValidations() (gas: 499495)
[PASS] test_sentUserOpWithSKEOAFailedBadMode() (gas: 487459)
[PASS] test_sentUserOpWithSKEOAFailedIsValidKey() (gas: 485752)
[PASS] test_sentUserOpWithSKEOAFailedKeyValidation() (gas: 512905)
[PASS] test_sentUserOpWithSKWebAuthn() (gas: 1662852)
[PASS] test_sentUserOpWithSKWebAuthnFailedAllValidations() (gas: 1423444)
Suite result: ok. 13 passed; 0 failed; 0 skipped; finished in 6.98s (4.37s CPU time)

Ran 3 tests for test/by-contract/KeyManagerTest.t.sol:KeysManagerMasterKey
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13475)
[PASS] test_MKinitializeRevert() (gas: 584509)
Suite result: ok. 3 passed; 0 failed; 0 skipped; finished in 3.22s (378.59ms CPU time)

Ran 25 tests for test/unit/KeysManager.t.sol:KeysManager
[PASS] test_AfterDeploy7702() (gas: 35068)
[PASS] test_Attched7702() (gas: 13682)
[PASS] test_RegisterKeyAAwithMK() (gas: 1805746)
[PASS] test_RegisterKeyAAwithRootKey() (gas: 1315937)
[PASS] test_RegisterKeyWithRootKey() (gas: 5394744)
[PASS] test_RemoveCanCallAAWithMK() (gas: 3187985)
[PASS] test_RemoveCanCallAAWithRootKey() (gas: 1746331)
[PASS] test_RemoveCanCallWithRootKey() (gas: 1880109)
[PASS] test_RemoveTokenSpendAAWithRootKey() (gas: 1830095)
[PASS] test_RemoveTokenSpendWithRootKey() (gas: 1592449)
[PASS] test_RevokeKeyAAwithMK() (gas: 2276799)
[PASS] test_RevokeKeyAAwithRootKey() (gas: 1311318)
[PASS] test_RevokeKeyWithRootKey() (gas: 5239356)
[PASS] test_SetCanCallAAWithMK() (gas: 2679741)
[PASS] test_SetCanCallAAWithRootKey() (gas: 1638069)
[PASS] test_SetCanCallWithRootKey() (gas: 1830070)
[PASS] test_SetTokenSpendAAWithMK() (gas: 2803864)
[PASS] test_SetTokenSpendAAWithRootKey() (gas: 1839300)
[PASS] test_SetTokenSpendWithRootKey() (gas: 1658984)
[PASS] test_UpdateKeyAAwithMK() (gas: 2526547)
[PASS] test_UpdateKeyAAwithRootKey() (gas: 1567906)
[PASS] test_UpdateKeyWithRootKey() (gas: 6338165)
[PASS] test_UpdateTokenSpendAAWithMK() (gas: 3489127)
[PASS] test_UpdateTokenSpendAAWithRootKey() (gas: 2064188)
[PASS] test_UpdateTokenSpendWithRootKey() (gas: 1825199)
Suite result: ok. 25 passed; 0 failed; 0 skipped; finished in 30.17s (27.16s CPU time)

Ran 15 tests for test/unit/DepositAndTransferETH.t.sol:DepositAndTransferETH
[PASS] test_AfterDeploy7702() (gas: 35045)
[PASS] test_Attched7702() (gas: 13590)
[PASS] test_DepositNativeFromEOA() (gas: 128768)
[PASS] test_ExecuteAABatchWithMK() (gas: 796242)
[PASS] test_ExecuteAABatchWithRootKey() (gas: 282186)
[PASS] test_ExecuteAABatchWithSKP256NonSelf() (gas: 1040713)
[PASS] test_ExecuteAABatchWithSKP256Self() (gas: 1040079)
[PASS] test_ExecuteAAWithMK() (gas: 748363)
[PASS] test_ExecuteAAWithRootKey() (gas: 258013)
[PASS] test_ExecuteAAWithSKEOASelf() (gas: 631367)
[PASS] test_ExecuteAAWithSKP256NonSelf() (gas: 986986)
[PASS] test_ExecuteAAWithSKP256Self() (gas: 985759)
[PASS] test_ExecuteBatchAAWithSKEOASelf() (gas: 686216)
[PASS] test_ExecuteDirectWithRootKey() (gas: 167557)
[PASS] test_TransferDirectFromAccount() (gas: 129959)
Suite result: ok. 15 passed; 0 failed; 0 skipped; finished in 36.28s (4.61s CPU time)

Ran 4 tests for test/fuzz/RecoveryFuzz.t.sol:RecoveryFuzz
[PASS] testFuzz_completeRecovery(address,uint8) (runs: 256, μ: 616055, ~: 511105)
[PASS] testFuzz_startRecovery(address) (runs: 256, μ: 203195, ~: 203195)
[PASS] test_AfterDeploy7702() (gas: 35022)
[PASS] test_Attched7702() (gas: 13452)
Suite result: ok. 4 passed; 0 failed; 0 skipped; finished in 73.74s (103.56s CPU time)

Ran 10 tests for test/invariant/CoreInvariant.t.sol:CoreInvariantTest
[PASS] invariant_ConfigurationAddressesImmutable() (runs: 256, calls: 128000, reverts: 4866)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 265     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1289    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3220    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_GuardianCountMatches() (runs: 256, calls: 128000, reverts: 5015)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 285     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 93      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1301    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3336    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_GuardianQuorumMaintained() (runs: 256, calls: 128000, reverts: 4874)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 267     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1285    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3230    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_GuardianQuorumMatchesCountExact() (runs: 256, calls: 128000, reverts: 4850)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 259     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1274    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3225    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_GuardianUniqueness() (runs: 256, calls: 128000, reverts: 4880)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 255     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1266    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3267    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_KeyActivitySynchronized() (runs: 256, calls: 128000, reverts: 4771)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 235     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1197    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3247    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_LockClearsWithNoRecovery() (runs: 256, calls: 128000, reverts: 4903)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 256     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1282    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3273    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_MasterKeyProperties() (runs: 256, calls: 128000, reverts: 4847)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 271     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1276    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3208    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_NonMasterKeysCarryLimits() (runs: 256, calls: 128000, reverts: 4943)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 272     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1256    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3323    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

[PASS] invariant_SingleActiveMasterKey() (runs: 256, calls: 128000, reverts: 4944)

╭------------------+------------------+-------+---------+----------╮
| Contract         | Selector         | Calls | Reverts | Discards |
+==================================================================+
| InvariantHandler | addGuardian      | 14379 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | cancelRecovery   | 14142 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | completeRecovery | 14204 | 271     | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | registerKey      | 14109 | 92      | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeGuardian   | 14214 | 1237    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | revokeKey        | 14261 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | startRecovery    | 14029 | 3344    | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | updateKey        | 14373 | 0       | 0        |
|------------------+------------------+-------+---------+----------|
| InvariantHandler | warp             | 14289 | 0       | 0        |
╰------------------+------------------+-------+---------+----------╯

Suite result: ok. 10 passed; 0 failed; 0 skipped; finished in 216.73s (896.63s CPU time)

Ran 19 tests for test/unit/Execution.t.sol:Execution
[PASS] test_AfterDeploy7702() (gas: 35091)
[PASS] test_Attched7702() (gas: 13613)
[PASS] test_ExecuteAAWithRootKey() (gas: 248266)
[PASS] test_ExecuteBatchAAWithMKAndTrasfer() (gas: 747353)
[PASS] test_ExecuteBatchAAWithRootKey() (gas: 270724)
[PASS] test_ExecuteBatchAAWithRootKeyAndTrasfer() (gas: 261644)
[PASS] test_ExecuteBatchAAWithSKEOASelfAndTrasfer() (gas: 615054)
[PASS] test_ExecuteBatchAAWithSKP256NonSelfAndTrasfer() (gas: 970452)
[PASS] test_ExecuteBatchAAWithSKP256SelfAndTrasfer() (gas: 972516)
[PASS] test_ExecuteBatchDirectWithRootKey() (gas: 176423)
[PASS] test_ExecuteBatchDirectWithRootKeyRevertInvalidTransactionLength() (gas: 107329)
[PASS] test_ExecuteBatchofBatchesAAWithMKAndTrasfer() (gas: 831320)
[PASS] test_ExecuteBatchofBatchesAAWithRootKeyAndTrasfer() (gas: 328764)
[PASS] test_ExecuteBatchofBatchesAAWithSKEOASelfAndTrasfer() (gas: 753991)
[PASS] test_ExecuteBatchofBatchesAAWithSKP256NonSelfAndTrasfer() (gas: 1110839)
[PASS] test_ExecuteBatchofBatchesAAWithSKP256SelfAndTrasfer() (gas: 1110505)
[PASS] test_ExecuteDirectWithRootKey() (gas: 155243)
[PASS] test_executeMode3RevertTooManyCalls() (gas: 237744)
[PASS] test_supportsExecutionMode() (gas: 25746)
Suite result: ok. 19 passed; 0 failed; 0 skipped; finished in 223.84s (8.05s CPU time)

Ran 5 tests for test/invariant/KeysManagerInvariant.t.sol:KeysManagerInvariantTest
[PASS] invariant_CanExecuteEnumerationConsistent() (runs: 256, calls: 128000, reverts: 4825)

╭--------------------+-------------------------+-------+---------+----------╮
| Contract           | Selector                | Calls | Reverts | Discards |
+===========================================================================+
| KeysManagerHandler | clearExecutePermissions | 11569 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | clearSpendPermissions   | 11658 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | pauseKey                | 11636 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | registerKey             | 11562 | 2863    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | removeTokenSpend        | 11598 | 747     | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | revokeKey               | 11722 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setCanCall              | 11594 | 1215    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setTokenSpend           | 11555 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | unpauseKey              | 11678 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateKey               | 11839 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateTokenSpend        | 11589 | 0       | 0        |
╰--------------------+-------------------------+-------+---------+----------╯

[PASS] invariant_DelegatedControlKeysHaveLimits() (runs: 256, calls: 128000, reverts: 4848)

╭--------------------+-------------------------+-------+---------+----------╮
| Contract           | Selector                | Calls | Reverts | Discards |
+===========================================================================+
| KeysManagerHandler | clearExecutePermissions | 11569 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | clearSpendPermissions   | 11658 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | pauseKey                | 11636 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | registerKey             | 11562 | 2859    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | removeTokenSpend        | 11598 | 777     | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | revokeKey               | 11722 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setCanCall              | 11594 | 1212    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setTokenSpend           | 11555 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | unpauseKey              | 11678 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateKey               | 11839 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateTokenSpend        | 11589 | 0       | 0        |
╰--------------------+-------------------------+-------+---------+----------╯

[PASS] invariant_InterfaceSupport() (runs: 256, calls: 128000, reverts: 4845)

╭--------------------+-------------------------+-------+---------+----------╮
| Contract           | Selector                | Calls | Reverts | Discards |
+===========================================================================+
| KeysManagerHandler | clearExecutePermissions | 11569 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | clearSpendPermissions   | 11658 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | pauseKey                | 11636 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | registerKey             | 11562 | 2858    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | removeTokenSpend        | 11598 | 754     | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | revokeKey               | 11722 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setCanCall              | 11594 | 1233    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setTokenSpend           | 11555 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | unpauseKey              | 11678 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateKey               | 11839 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateTokenSpend        | 11589 | 0       | 0        |
╰--------------------+-------------------------+-------+---------+----------╯

[PASS] invariant_KeyValidityOrdering() (runs: 256, calls: 128000, reverts: 4864)

╭--------------------+-------------------------+-------+---------+----------╮
| Contract           | Selector                | Calls | Reverts | Discards |
+===========================================================================+
| KeysManagerHandler | clearExecutePermissions | 11569 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | clearSpendPermissions   | 11658 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | pauseKey                | 11636 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | registerKey             | 11562 | 2864    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | removeTokenSpend        | 11598 | 778     | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | revokeKey               | 11722 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setCanCall              | 11594 | 1222    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setTokenSpend           | 11555 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | unpauseKey              | 11678 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateKey               | 11839 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateTokenSpend        | 11589 | 0       | 0        |
╰--------------------+-------------------------+-------+---------+----------╯

[PASS] invariant_SpendTokensConsistency() (runs: 256, calls: 128000, reverts: 4848)

╭--------------------+-------------------------+-------+---------+----------╮
| Contract           | Selector                | Calls | Reverts | Discards |
+===========================================================================+
| KeysManagerHandler | clearExecutePermissions | 11569 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | clearSpendPermissions   | 11658 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | pauseKey                | 11636 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | registerKey             | 11562 | 2851    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | removeTokenSpend        | 11598 | 777     | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | revokeKey               | 11722 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setCanCall              | 11594 | 1220    | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | setTokenSpend           | 11555 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | unpauseKey              | 11678 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateKey               | 11839 | 0       | 0        |
|--------------------+-------------------------+-------+---------+----------|
| KeysManagerHandler | updateTokenSpend        | 11589 | 0       | 0        |
╰--------------------+-------------------------+-------+---------+----------╯

Suite result: ok. 5 passed; 0 failed; 0 skipped; finished in 487.98s (1316.28s CPU time)

Ran 25 test suites in 488.04s (1112.79s CPU time): 281 tests passed, 0 failed, 0 skipped (281 total tests)

╭-------------------------------------------+--------------------+--------------------+------------------+------------------╮
| File                                      | % Lines            | % Statements       | % Branches       | % Funcs          |
+===========================================================================================================================+
| script/Deploy7702.s.sol                   | 0.00% (0/13)       | 0.00% (0/14)       | 0.00% (0/2)      | 0.00% (0/2)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| script/DeployGasPolicy.s.sol              | 0.00% (0/23)       | 0.00% (0/25)       | 0.00% (0/5)      | 0.00% (0/1)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| script/DeployMockErc20.s.sol              | 0.00% (0/12)       | 0.00% (0/13)       | 0.00% (0/2)      | 0.00% (0/2)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| script/DeployWebAuthnVerifierV2.s.sol     | 0.00% (0/21)       | 0.00% (0/23)       | 0.00% (0/5)      | 0.00% (0/1)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/BaseOPF7702.sol                  | 81.63% (40/49)     | 79.25% (42/53)     | 28.57% (2/7)     | 91.67% (11/12)   |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/Execution.sol                    | 91.43% (32/35)     | 93.48% (43/46)     | 100.00% (6/6)    | 100.00% (6/6)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/KeysManager.sol                  | 93.04% (147/158)   | 92.90% (144/155)   | 100.00% (11/11)  | 100.00% (29/29)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702.sol                      | 95.22% (199/209)   | 96.34% (237/246)   | 96.08% (49/51)   | 100.00% (19/19)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702Recoverable.sol           | 93.62% (44/47)     | 93.48% (43/46)     | 100.00% (3/3)    | 100.00% (7/7)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPFMain.sol                      | 66.67% (2/3)       | 50.00% (1/2)       | 100.00% (0/0)    | 100.00% (1/1)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/Base64.sol                       | 0.00% (0/61)       | 0.00% (0/57)       | 0.00% (0/5)      | 0.00% (0/4)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/Initializable.sol                | 45.71% (16/35)     | 52.94% (18/34)     | 42.86% (3/7)     | 28.57% (2/7)     |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/KeyDataValidationLib.sol         | 100.00% (7/7)      | 100.00% (9/9)      | 100.00% (1/1)    | 100.00% (3/3)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/KeysManagerLib.sol               | 81.58% (31/38)     | 82.05% (32/39)     | 87.50% (7/8)     | 100.00% (13/13)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/P256.sol                         | 0.00% (0/40)       | 0.00% (0/35)       | 0.00% (0/4)      | 0.00% (0/5)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/SigLengthLib.sol                 | 88.89% (8/9)       | 94.12% (16/17)     | 0.00% (0/1)      | 100.00% (1/1)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/UpgradeAddress.sol               | 71.43% (35/49)     | 69.57% (32/46)     | 0.00% (0/10)     | 100.00% (9/9)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/libs/WebAuthn.sol                     | 0.00% (0/115)      | 0.00% (0/115)      | 0.00% (0/13)     | 0.00% (0/10)     |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/mocks/ERC1155Mock.sol                 | 0.00% (0/6)        | 0.00% (0/3)        | 100.00% (0/0)    | 0.00% (0/3)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/mocks/ERC721Mock.sol                  | 0.00% (0/9)        | 0.00% (0/9)        | 100.00% (0/0)    | 0.00% (0/3)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/mocks/MockERC20.sol                   | 100.00% (2/2)      | 100.00% (1/1)      | 100.00% (0/0)    | 100.00% (1/1)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/mocks/SimpleContract.sol              | 0.00% (0/12)       | 0.00% (0/10)       | 0.00% (0/4)      | 0.00% (0/4)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/ERC7201.sol                     | 0.00% (0/2)        | 0.00% (0/1)        | 100.00% (0/0)    | 0.00% (0/1)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/GasPolicy.sol                   | 94.12% (64/68)     | 91.36% (74/81)     | 66.67% (10/15)   | 90.00% (9/10)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/SocialRecover.sol               | 99.43% (173/174)   | 96.55% (196/203)   | 83.67% (41/49)   | 100.00% (20/20)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/WebAuthnVerifier.sol            | 0.00% (0/18)       | 0.00% (0/17)       | 100.00% (0/0)    | 0.00% (0/5)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/WebAuthnVerifierV2.sol          | 0.00% (0/14)       | 0.00% (0/13)       | 100.00% (0/0)    | 0.00% (0/3)      |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/BaseData.t.sol                       | 93.02% (40/43)     | 90.00% (27/30)     | 100.00% (6/6)    | 100.00% (14/14)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/Data.t.sol                           | 0.00% (0/23)       | 100.00% (0/0)      | 100.00% (0/0)    | 0.00% (0/23)     |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/SignersData.t.sol                    | 100.00% (17/17)    | 100.00% (21/21)    | 100.00% (0/0)    | 100.00% (4/4)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/by-contract/KeyManagerTest.t.sol     | 71.43% (15/21)     | 64.71% (11/17)     | 100.00% (0/0)    | 100.00% (6/6)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/invariant/CoreInvariant.t.sol        | 93.72% (224/239)   | 94.61% (281/297)   | 45.45% (5/11)    | 100.00% (18/18)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/invariant/KeysManagerInvariant.t.sol | 91.62% (175/191)   | 92.80% (219/236)   | 66.67% (6/9)     | 91.67% (22/24)   |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| test/storage/ClearStorage.t.sol           | 54.55% (12/22)     | 56.52% (13/23)     | 100.00% (0/0)    | 100.00% (2/2)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| Total                                     | 71.88% (1283/1785) | 75.37% (1460/1937) | 63.83% (150/235) | 72.16% (197/273) |
╰-------------------------------------------+--------------------+--------------------+------------------+------------------╯

╭-------------------------------------------+--------------------+--------------------+------------------+------------------╮
| File                                      | % Lines            | % Statements       | % Branches       | % Funcs          |
+===========================================================================================================================+
| src/core/BaseOPF7702.sol                  | 81.63% (40/49)     | 79.25% (42/53)     | 28.57% (2/7)     | 91.67% (11/12)   |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/Execution.sol                    | 91.43% (32/35)     | 93.48% (43/46)     | 100.00% (6/6)    | 100.00% (6/6)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/KeysManager.sol                  | 93.04% (147/158)   | 92.90% (144/155)   | 100.00% (11/11)  | 100.00% (29/29)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702.sol                      | 95.22% (199/209)   | 96.34% (237/246)   | 96.08% (49/51)   | 100.00% (19/19)  |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPF7702Recoverable.sol           | 93.62% (44/47)     | 93.48% (43/46)     | 100.00% (3/3)    | 100.00% (7/7)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/core/OPFMain.sol                      | 66.67% (2/3)       | 50.00% (1/2)       | 100.00% (0/0)    | 100.00% (1/1)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/GasPolicy.sol                   | 95.59% (65/68)     | 92.59% (75/81)     | 73.33% (11/15)   | 90.00% (9/10)    |
|-------------------------------------------+--------------------+--------------------+------------------+------------------|
| src/utils/SocialRecover.sol               | 99.43% (173/174)   | 96.55% (196/203)   | 83.67% (41/49)   | 100.00% (20/20)  |
╰-------------------------------------------+--------------------+--------------------+------------------+------------------╯
